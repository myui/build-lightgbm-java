env:
  global:
   - LIGHTGBM_VERSION=2.3.1
   - secure: "NRdE4Rl1FaoiplaWovzPfS4R4l+3QPgo4P/OC3z5Nz9yphIOu9hgzNVkpKaJ7ZDHkl6Bi8CQJS4P5fyZFaj9dgYeoZIwqzv32V993x6ygs6wfrdrjtz7fbCIaho77wshBKVefyMZPqsWc+tsGPX7EnX4SBA3uRyzLaeQFwslLmYD++La8E7HoJb8Ehnr2om+Zu0V3FRKHPoSVOFD9+oDp49v+76P5NH1Q69/Rj4/HcysTZ4BhEzLcq5vG8hYQkq8n6J/h+uKteasKOXA/S5loWEamKA3uj2bzk8NiZMf7hVQPWJztPk+lwW7c5I7+ou4puCVrq9n056MAJ6kej0+LOWoZv1gYeGXaKJdHpyLCmp5uSllS2HHXAEp4D4nRUhqcNfhrjxv6z7/pwVXjKImwCeSGS8rACyvHe9ckEYOrpjf2nfALfJ+AXixgRUd/o3YePM2CXWxryDGjhMnXeXwd0ok+C31YJpwKYhUmfdxQTXxqDqNiSICXfnHFxUFt3wkghgnhdTMTplnxFSxs5h+SLVWR41AC6qp9R3gVsl1sVHOo6+xATtigHNhGd5nALvPZaMtvRmubOp9IuVpdXiO/49FPpaQIQYyr/pphPdBOHcLoToZo/j2ZOa6IgLB6uMGBSbPSVWu713yVXOmWsaVZsGzoyfQpI6kIqIJkicrXfg="
     # ENV['NEXUS_PASSWD'] generated by `travis encrypt NEXUS_PASSWD=xxxx`

language: java

# Caching so the next build will be fast too.
cache:
  apt: true
  directories:
    - $HOME/.m2
    - $HOME/Library/Caches/Homebrew

matrix:
  include:
    - os: linux
      sudo: false
      dist: precise
      group: deprecated-2017Q4
      jdk: openjdk7
    - os: osx
      osx_image: xcode10

# xcode10 use cmake version 3.12.2

addons:
  homebrew:
    packages:
    - swig

notifications:
  email: false

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
        sudo apt-get remove -y --purge mongodb;
        sudo rm /etc/apt/sources.list.d/mongodb.list;
        sudo apt-get update;
        sudo apt-get -y install software-properties-common python-software-properties;
        sudo add-apt-repository -y ppa:roblib/ppa;
        sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test;
        sudo apt-get update;
    fi
  - if [[ "$TRAVIS_DIST" == "precise" ]]; then
        sudo apt-get update;
        sudo add-apt-repository -y ppa:george-edison55/precise-backports;
        sudo add-apt-repository -y ppa:git-core/ppa;
        sudo apt-get update;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
        brew analytics off;
    fi

install:
  - if [[ "$TRAVIS_DIST" == "precise" ]]; then
        sudo apt-get install -y binutils git g++-5 make cmake cmake-data libpthread-stubs0-dev swig;
    fi

script:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
        sh scripts/build_osx.sh;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
        CC=`which gcc-5` CXX=`which g++-5` sh scripts/build_linux.sh;
    fi

deploy:
  provider: releases
  api_key:
    secure: dJuA7rh/NHcTs9J6vqUn4lH6kFDBYX3KO+JPNCPDid2RTua+j7Hf4599BqzHoDkSr/hdhgCcGfajFYpIEzl7SjJQIi1rHTHeepEtBMh3gZmcRHo+zEVMsU3XyEWL9hX3vYYPSteCUZwILiklJTukadzznAKbcgjjAh5M7ImsVseYI0R7Orth9B5mQr8JtyEWVoF47fojWgA8S7ofHt/4/F9Lh9JpvNj4/UTx8nmCmDwflBRpyOvws65oTGVF7Nh6s0hwmchrzCyrCoiSmOS/u3TE9VGXfMIn8LcGknLsmQ2ct5OvBImbHzGgxtF0UFdSdTORdXnUcu0fCSZudxj2BPAlbmdgOQKyhtxPJ2RxrRw6VUaea0N13Su8EFgoQm7JVlUkCfP3LjyEcPZSq3UKKVcWAEm2U5QluOQmeoLqoySsDxJcfVDVGFkMqz/cTugWXShmU1fc2XVkEeSq1pmMpp2GXRgNss4w5Fhz45VAwlc1eo4LZ/KDOIKiD7nA9pImvrkwwTeWlvz3CfQ1Fgn8JE6NYZoNhQ0n4i7a2Nna53tfNbyu7z1eYMKXXH0wCrAaCHoYKK7bG2nuRkvgoO6bgYvKd7iXwcnZjKcNrPEHRLyQGm6LeXSUbC/Dw/OdR3dpkQtvNvvUFsqOkV5K5Qv7GA7jDaXP6Ulp+u5ovnBaOyk=
  file:
    - lightgbm4j-$LIGHTGBM_VERSION-$TRAVIS_OS_NAME-$TRAVIS_DIST.jar
    - lightgbm4j-$LIGHTGBM_VERSION-$TRAVIS_OS_NAME.jar
  on:
    repo: myui/build-lightgbm-jvm
    tags: true
  skip_cleanup: true # do not delete the built assets
  overwrite: true
